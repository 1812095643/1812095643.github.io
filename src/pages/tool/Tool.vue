<template>
  <div class="tool">
    <div class="scroll-indicator">
      <div class="scroll-thumb" :style="{ height: scrollProgress + '%' }"></div>
    </div>
    <div class="tool-list">
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://github.com/hoppscotch/hoppscotch" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">Hoppscotch</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  开源的API测试客户端，Postman的完美替代品。支持REST、GraphQL、WebSocket等多种协议，界面简洁，功能强大。
                </div>
                <div class="time">2024-12-01 · API测试工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://jsonformatter.curiousconcept.com/" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">JSON Formatter</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  在线JSON格式化、验证和美化工具。支持JSON压缩、语法高亮、错误检测，是开发者处理JSON数据的必备工具。
                </div>
                <div class="time">2024-11-28 · 格式化工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://regexr.com/" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">RegExr</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  强大的正则表达式学习、构建和测试工具。提供实时匹配、详细解释和丰富的示例，帮助开发者掌握正则表达式。
                </div>
                <div class="time">2024-11-25 · 正则工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://www.base64encode.org/" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">Base64 Encoder</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  在线Base64编码解码工具，支持文本、文件的Base64转换。界面简洁，操作便捷，是Web开发中常用的编码工具。
                </div>
                <div class="time">2024-11-22 · 编码工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://caniuse.com/" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">Can I Use</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  浏览器兼容性查询工具，帮助开发者检查HTML、CSS、JavaScript特性在各浏览器中的支持情况。
                </div>
                <div class="time">2024-11-20 · 兼容性工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://bundlephobia.com/" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">Bundle Phobia</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  分析npm包大小的工具，帮助开发者了解包的体积、依赖关系和加载时间，优化项目性能。
                </div>
                <div class="time">2024-11-18 · 性能分析</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://github.com/GoogleChrome/lighthouse" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">Lighthouse</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  Google开源的网站质量审计工具，从性能、可访问性、SEO等多个维度评估网页质量，提供优化建议。
                </div>
                <div class="time">2024-11-15 · 性能工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://transform.tools/" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">Transform Tools</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  多功能在线转换工具集合，支持JSON、TypeScript、GraphQL等多种格式之间的相互转换，提高开发效率。
                </div>
                <div class="time">2024-11-12 · 转换工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a
            href="https://github.com/responsively-org/responsively-app"
            target="_blank"
          >
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">Responsively App</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  专为响应式开发设计的浏览器，可以同时预览网页在多种设备尺寸下的显示效果，提高响应式开发效率。
                </div>
                <div class="time">2024-11-10 · 响应式工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://httpie.io/" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">HTTPie</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  现代化的命令行HTTP客户端，支持JSON、语法高亮、会话管理等功能，为开发者提供便捷的HTTP请求方式。
                </div>
                <div class="time">2024-11-08 · HTTP工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a
            href="https://github.com/modelcontextprotocol/servers"
            target="_blank"
          >
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">MCP Servers</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  Model Context
                  Protocol服务器集合，为AI模型提供标准化的上下文访问接口，支持文件系统、数据库、API等多种数据源。
                </div>
                <div class="time">2024-12-15 · MCP工具</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://github.com/langchain-ai/langchain" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">LangChain</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  构建LLM应用的开源框架，提供链式调用、记忆管理、Agent代理等功能，是开发AI应用的强大工具链。
                </div>
                <div class="time">2024-12-12 · AI框架</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://github.com/microsoft/autogen" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">AutoGen</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  微软开源的多Agent对话框架，支持多个AI代理之间的协作和对话，可构建复杂的AI工作流。
                </div>
                <div class="time">2024-12-10 · Agent框架</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a
            href="https://github.com/Significant-Gravitas/AutoGPT"
            target="_blank"
          >
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">AutoGPT</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  自主AI代理工具，能够自动执行复杂任务，具备自我改进和目标导向的能力，是AGI探索的重要项目。
                </div>
                <div class="time">2024-12-08 · 自主Agent</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://github.com/run-llama/llama_index" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">LlamaIndex</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  数据框架，专门为LLM应用提供数据连接和索引服务，支持RAG（检索增强生成）等高级AI应用模式。
                </div>
                <div class="time">2024-12-05 · 数据框架</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a
            href="https://github.com/anthropics/anthropic-sdk-python"
            target="_blank"
          >
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">Anthropic SDK</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  Anthropic官方SDK，提供Claude
                  AI模型的完整访问接口，支持对话、工具调用、MCP协议等功能。
                </div>
                <div class="time">2024-12-03 · AI SDK</div>
              </div>
            </div>
          </a>
        </div>
      </div>
      <div class="tool-list-item">
        <div class="magical item">
          <a href="https://github.com/openai/openai-python" target="_blank">
            <div class="card">
              <div class="card-left">
                <div class="title">
                  <div class="name">OpenAI Python SDK</div>
                  <div class="link">↗</div>
                </div>
                <div class="desc">
                  OpenAI官方Python
                  SDK，提供GPT、DALL-E、Whisper等模型的完整API访问，是AI开发的基础工具。
                </div>
                <div class="time">2024-12-01 · AI SDK</div>
              </div>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { onMounted, onBeforeUnmount, nextTick } from "vue";
import { usePageAnimations } from "../../composables/usePageAnimations";
import { useScrollProgress } from "../../composables/useScrollProgress";

// 使用页面动画和滚动进度
usePageAnimations();
const { scrollProgress } = useScrollProgress();

let scrollHandler: (() => void) | null = null;

// Tool页面动画管理
const initToolAnimations = () => {
  const vh = window.innerHeight;

  // 检查并激活可见的工具项
  const checkVisibleItems = () => {
    document.querySelectorAll<HTMLElement>(".tool-list-item").forEach((el) => {
      const rect = el.getBoundingClientRect();
      if (rect.top <= vh * 0.8 && rect.bottom >= -100) {
        el.classList.add("active");
      }
    });
  };

  // 立即执行一次检查
  checkVisibleItems();

  // 创建滚动监听器
  scrollHandler = () => {
    checkVisibleItems();
  };

  // 添加滚动监听
  window.addEventListener("scroll", scrollHandler);

  // 防抖处理，确保动画流畅
  let ticking = false;
  const optimizedScrollHandler = () => {
    if (!ticking) {
      requestAnimationFrame(() => {
        checkVisibleItems();
        ticking = false;
      });
      ticking = true;
    }
  };

  window.removeEventListener("scroll", scrollHandler);
  window.addEventListener("scroll", optimizedScrollHandler);
  scrollHandler = optimizedScrollHandler;
};

onMounted(() => {
  nextTick(() => {
    // 延迟初始化，确保DOM完全渲染
    setTimeout(() => {
      initToolAnimations();
    }, 100);
  });
});

onBeforeUnmount(() => {
  if (scrollHandler) {
    window.removeEventListener("scroll", scrollHandler);
  }
});
</script>

<style scoped>
/* Tool页面浮现动画样式 - 使用更高优先级覆盖全局样式 */
.tool .tool-list .tool-list-item {
  opacity: 0 !important;
  transform: translateY(30px) scale(0.95) !important;
  transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1) !important;
}

.tool .tool-list .tool-list-item:nth-child(odd) {
  flex-direction: row-reverse !important;
}

.tool .tool-list .tool-list-item.active {
  opacity: 1 !important;
  transform: translateY(0) scale(1) !important;
}

/* 闪烁效果关键帧 */
@keyframes shimmer {
  0% {
    box-shadow: 0 0 0 rgba(100, 97, 241, 0);
  }
  50% {
    box-shadow: 0 0 20px rgba(100, 97, 241, 0.3);
  }
  100% {
    box-shadow: 0 0 0 rgba(100, 97, 241, 0);
  }
}

/* 浮现后的闪烁效果 */
.tool .tool-list .tool-list-item.active .item {
  animation: shimmer 2s ease-in-out 0.5s !important;
}

/* 增强悬停效果 - 覆盖全局样式 */
.tool .tool-list .tool-list-item:hover {
  transform: translateY(-5px) scale(1.02) !important;
  transition: all 0.3s ease !important;
}

.tool .tool-list .tool-list-item:hover .item {
  box-shadow: 0 10px 30px rgba(100, 97, 241, 0.2) !important;
}

/* 卡片动画 */
.item a .card {
  transition: all 0.3s ease;
}

.item:hover a .card {
  transform: translateY(-2px);
}

/* 分阶段动画延迟 */
.tool-list-item:nth-child(1) {
  transition-delay: 0.1s;
}
.tool-list-item:nth-child(2) {
  transition-delay: 0.2s;
}
.tool-list-item:nth-child(3) {
  transition-delay: 0.3s;
}
.tool-list-item:nth-child(4) {
  transition-delay: 0.4s;
}
.tool-list-item:nth-child(5) {
  transition-delay: 0.5s;
}
.tool-list-item:nth-child(6) {
  transition-delay: 0.6s;
}
.tool-list-item:nth-child(7) {
  transition-delay: 0.7s;
}
.tool-list-item:nth-child(8) {
  transition-delay: 0.8s;
}
.tool-list-item:nth-child(9) {
  transition-delay: 0.9s;
}
.tool-list-item:nth-child(10) {
  transition-delay: 1s;
}
.tool-list-item:nth-child(11) {
  transition-delay: 1.1s;
}
.tool-list-item:nth-child(12) {
  transition-delay: 1.2s;
}
.tool-list-item:nth-child(13) {
  transition-delay: 1.3s;
}
.tool-list-item:nth-child(14) {
  transition-delay: 1.4s;
}
.tool-list-item:nth-child(15) {
  transition-delay: 1.5s;
}
.tool-list-item:nth-child(16) {
  transition-delay: 1.6s;
}
.tool-list-item:nth-child(17) {
  transition-delay: 1.7s;
}
.tool-list-item:nth-child(18) {
  transition-delay: 1.8s;
}

/* 响应式动画控制 */
@media (prefers-reduced-motion: reduce) {
  .tool-list-item,
  .item a .card {
    transition: none !important;
    transform: none !important;
    animation: none !important;
  }

  .tool-list-item {
    opacity: 1 !important;
  }
}
</style>
